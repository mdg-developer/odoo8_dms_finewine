<openerp>
  <data>
        
           
    
    <!-- Section tree -->
    <record model="ir.ui.view" id="view_attendance_data_import_tree">
        <field name="name">Attendance</field>
        <field name="model">attendance.data.import</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree string="Attendance Data Import">
                <field name="department_id" />
                <field name="fingerprint_id" />
                <field name="section_id" />
                
                <field name="employee_id"/>
				<field name="date"/>
				<field name="timetable"/>
				<field name="onduty"/>
				<field name="offduty"/>
				<field name="clockin"/>
				<field name="clockout"/>
				<field name="miss_punch_in"/>
				<field name="miss_punch_out"/>
				<field name="normal"/>
				<field name="realtime"/>
				<field name="late"/>
				<field name="early"/>
				<field name="absent"/>
				<field name="ot_time"/>
				<field name="work_time"/> 
				<field name="state"/>              
            </tree>
        </field>
    </record>
    
    <record id="view_attendance_filter" model="ir.ui.view">
            <field name="name">Attendance</field>
            <field name="model">attendance.data.import</field>
            <field name="arch" type="xml">
                <search string="Attendance">
                    <field name="fingerprint_id" />
                    <field name="employee_id" />
                    <field name="department_id" /> 
                    <filter string="OT" domain="[('ot_time', '>',0)]"/>
                    <filter string="Irregular" domain="['|',('clockin', '=',False),('clockout','=',False)]"/>  
                    <filter string="Today Absent" domain="[('absent','=',True),('date', '&gt;=', datetime.datetime.now().strftime('%Y-%m-%d 00:00:00')),('date', '&lt;=', datetime.datetime.now().strftime('%Y-%m-%d 23:23:59'))]"/>    
                    <filter string="Current Month"  
                        domain="[('date','&lt;=',(datetime.date.today()+relativedelta(day=31)).strftime('%Y-%m-%d')),
                        ('date','&gt;=',(datetime.date.today()-relativedelta(day=1)).strftime('%Y-%m-%d'))]"/>		 
					<filter string="Current Month OT"  
					domain="['&amp;',['date','&lt;=',(datetime.date.today()+relativedelta(day=31)).strftime('%Y-%m-%d')],['date','&gt;=',(datetime.date.today()-relativedelta(day=1)).strftime('%Y-%m-%d')],['ot_time', '>',0,]]"/>
					<filter string="Current Month Irregular"  
					domain="['&amp;',['date','&lt;=',(datetime.date.today()+relativedelta(day=31)).strftime('%Y-%m-%d')],['date','&gt;=',(datetime.date.today()-relativedelta(day=1)).strftime('%Y-%m-%d')],'|',('clockin','=',False),('clockout','=',False)]"/>
					
					<filter string="26 Previous Month to 25 Current Month" name="prev_month" 
					    domain="[('date','&gt;=',(context_today()-relativedelta(months=1)).strftime('%%Y-%%m-26')),
					    ('date','&lt;',time.strftime('%%Y-%%m-26'))]"/>
					                                                     
                    <group expand="0" string="Group By">
                        <filter string="Employee" icon="terp-personal" domain="[]" context="{'group_by':'employee_id'}"/>
                        <filter string="Department" icon="terp-personal+" domain="[]" context="{'group_by':'department_id'}"/>
                        <filter string="Section" icon="terp-personal+" domain="[]" context="{'group_by':'section_id'}"/>
                        <filter string="Status" icon="terp-gtk-select-all" domain="[]" context="{'group_by':'state'}"/>
                        <filter string="Date" icon="terp-gtk-select-all" domain="[]" context="{'group_by':'date'}"/>
                    </group>
                </search>
             </field>
         </record>
         
     <!-- Section form -->
    <record model="ir.ui.view" id="view_attendance_data_import_form">
        <field name="name">Attendance</field>
        <field name="model">attendance.data.import</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="Attendance">
                	<header>
						<button name="approve" string="Approve" type="object"
							class="oe_highlight" attrs="{'invisible':[('state','in',('approve','decline'))]}" />
						<button name="decline" string="Decline" type="object"
							class="oe_highlight" attrs="{'invisible':[('state','in',('approve','decline'))]}" />
						<button name="set_to_draft" string="Set to draft" type="object"
							class="oe_highlight" attrs="{'invisible':[('state','in',('draft'))]}" />	
						<field name="state" widget="statusbar" statusbar_visible="draft,approve,decline" />
					</header>
					<sheet>
	                <group>
							<group>
								<field name="fingerprint_id" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>									
								<field name="employee_id" on_change="employee_id_on_change(employee_id)" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="department_id" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="onduty" on_change="calculate_on_change(timetable,onduty,offduty,clockin, clockout)" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="clockin" on_change="calculate_on_change(timetable,onduty,offduty,clockin, clockout)" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="miss_punch_in" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="normal" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="late" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="absent" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="work_time" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<!-- <field name="must_in" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>								
								<field name="weekend" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="att_time" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="weekend_ot" attrs="{'readonly':[('state','in',('approve','decline'))]}"/> -->
								
							</group>
							<group>
								<field name="date" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="timetable" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="ndays" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="offduty" on_change="calculate_on_change(timetable,onduty,offduty,clockin, clockout)" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="clockout" on_change="calculate_on_change(timetable,onduty,offduty,clockin, clockout)" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="miss_punch_out" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="realtime" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="early" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="ot_time" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="remark" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="section_id" invisible="1" />
								<!-- <field name="exception" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="must_out" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								
								<field name="holiday" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="ndays_ot" attrs="{'readonly':[('state','in',('approve','decline'))]}"/>
								<field name="holiday_ot" attrs="{'readonly':[('state','in',('approve','decline'))]}"/> -->
							</group>

						</group>
	               
	               </sheet>
                
            </form>
        </field>
    </record>
     <!-- Menu -->
    <record model="ir.actions.act_window" id="open_view_attendance_data_import_form">
        <field name="name">Attendance</field>
        <field name="res_model">attendance.data.import</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_attendance_filter"/>
    </record>
                       
	<menuitem id="menu_hr_attendance_parent" parent='hr.menu_hr_root'  name="Attendance" sequence="16"/>
	<menuitem name="Attendance"
              parent="attendance_data_import_v2.menu_hr_attendance_parent" 
              id="menu_attendane_data_form"
              action="open_view_attendance_data_import_form" sequence="2" />      
     
  </data>
</openerp>
